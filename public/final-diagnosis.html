<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–§–ò–ù–ê–õ–¨–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê API</title>
    <style>
        body { font-family: Arial; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .container { max-width: 700px; margin: 0 auto; background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); padding: 30px; border-radius: 15px; }
        button { padding: 15px 25px; font-size: 16px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; width: 100%; margin: 8px 0; transition: all 0.3s; }
        button:hover { background: #218838; transform: translateY(-2px); }
        .result { margin: 15px 0; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 14px; }
        .success { background: rgba(40, 167, 69, 0.2); border: 1px solid #28a745; }
        .error { background: rgba(220, 53, 69, 0.2); border: 1px solid #dc3545; }
        .loading { background: rgba(255, 193, 7, 0.2); border: 1px solid #ffc107; }
        pre { white-space: pre-wrap; word-break: break-all; }
        h1 { text-align: center; margin-bottom: 30px; }
        .status { font-weight: bold; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ –§–ò–ù–ê–õ–¨–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê API</h1>
        <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ API endpoints –ø–æ –ø–æ—Ä—è–¥–∫—É:</p>
        
        <button onclick="testHello()">1Ô∏è‚É£ –¢–ï–°–¢ /api/hello (–ø—Ä–æ—Å—Ç–µ–π—à–∏–π)</button>
        <button onclick="testTelegram()">2Ô∏è‚É£ –¢–ï–°–¢ /api/telegram (Telegram API)</button>
        <button onclick="testMainForm()">3Ô∏è‚É£ –¢–ï–°–¢ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º—ã</button>
        
        <div id="results"></div>
        
        <div style="margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 10px;">
            <h3>üîç –ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h3>
            <ul>
                <li><strong>‚úÖ Success:</strong> API —Ä–∞–±–æ—Ç–∞–µ—Ç, JSON –ø–æ–ª—É—á–µ–Ω</li>
                <li><strong>‚ùå 404 Error:</strong> Vercel –Ω–µ –≤–∏–¥–∏—Ç API endpoint</li>
                <li><strong>‚ùå HTML Error:</strong> –ü–æ–ª—É—á–∏–ª–∏ HTML –≤–º–µ—Å—Ç–æ JSON (404 —Å—Ç—Ä–∞–Ω–∏—Ü–∞)</li>
                <li><strong>‚ùå Network Error:</strong> –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é</li>
            </ul>
        </div>
    </div>

    <script>
        function addResult(content, type = 'loading') {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = content;
            resultsDiv.appendChild(resultDiv);
            return resultDiv;
        }

        async function testHello() {
            const resultDiv = addResult('<div class="status">üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º /api/hello...</div>', 'loading');
            
            try {
                const response = await fetch('/api/hello');
                console.log('Hello API Response:', response.status, response.statusText);
                
                const responseText = await response.text();
                console.log('Hello API Response text:', responseText);
                
                if (response.status === 404) {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<div class="status">‚ùå /api/hello –ùE –ù–ê–ô–î–ï–ù</div>Vercel –Ω–µ –≤–∏–¥–∏—Ç –ø—Ä–æ—Å—Ç–µ–π—à–∏–π API endpoint';
                    return;
                }
                
                let result;
                try {
                    result = JSON.parse(responseText);
                } catch (e) {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<div class="status">‚ùå /api/hello –í–û–ó–í–†–ê–©–ê–ï–¢ HTML</div><pre>' + responseText.substring(0, 200) + '...</pre>';
                    return;
                }
                
                resultDiv.className = 'result success';
                resultDiv.innerHTML = '<div class="status">‚úÖ /api/hello –†–ê–ë–û–¢–ê–ï–¢!</div><pre>' + JSON.stringify(result, null, 2) + '</pre>';
                
            } catch (error) {
                console.error('Hello API Error:', error);
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<div class="status">‚ùå /api/hello –°–ï–¢–ï–í–ê–Ø –û–®–ò–ë–ö–ê</div>' + error.message;
            }
        }
        
        async function testTelegram() {
            const resultDiv = addResult('<div class="status">üì§ –¢–µ—Å—Ç–∏—Ä—É–µ–º /api/telegram...</div>', 'loading');
            
            const testData = {
                name: '–§–ò–ù–ê–õ–¨–ù–´–ô –¢–ï–°–¢',
                phone: '+7 918 040-04-02',
                comment: '–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç API - ' + new Date().toLocaleTimeString()
            };
            
            try {
                const response = await fetch('/api/telegram', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testData)
                });
                
                console.log('Telegram API Response:', response.status, response.statusText);
                
                const responseText = await response.text();
                console.log('Telegram API Response text:', responseText);
                
                if (response.status === 404) {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<div class="status">‚ùå /api/telegram –ùE –ù–ê–ô–î–ï–ù</div>Telegram API endpoint –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç';
                    return;
                }
                
                let result;
                try {
                    result = JSON.parse(responseText);
                } catch (e) {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<div class="status">‚ùå /api/telegram –í–û–ó–í–†–ê–©–ê–ï–¢ HTML</div><pre>' + responseText.substring(0, 200) + '...</pre>';
                    return;
                }
                
                if (response.ok && result.success) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = '<div class="status">‚úÖ /api/telegram –†–ê–ë–û–¢–ê–ï–¢!</div>–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Telegram!<br><pre>' + JSON.stringify(result, null, 2) + '</pre>';
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<div class="status">‚ùå /api/telegram –û–®–ò–ë–ö–ê</div><pre>' + JSON.stringify(result, null, 2) + '</pre>';
                }
                
            } catch (error) {
                console.error('Telegram API Error:', error);
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<div class="status">‚ùå /api/telegram –û–®–ò–ë–ö–ê</div>' + error.message;
            }
        }
        
        async function testMainForm() {
            const resultDiv = addResult('<div class="status">üè† –°–∏–º—É–ª—è—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º—ã...</div>', 'loading');
            
            // –°–∏–º—É–ª–∏—Ä—É–µ–º —Ç–æ –∂–µ —Å–∞–º–æ–µ —á—Ç–æ –¥–µ–ª–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º–∞
            const formData = {
                name: '–¢–ï–°–¢ –û–°–ù–û–í–ù–û–ô –§–û–†–ú–´',
                phone: '+7 918 040-04-02',
                comment: '–¢–µ—Å—Ç —á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω—É—é —Ñ–æ—Ä–º—É - ' + new Date().toLocaleTimeString()
            };
            
            try {
                const response = await fetch('/api/telegram', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = '<div class="status">‚úÖ –û–°–ù–û–í–ù–ê–Ø –§–û–†–ú–ê –ë–£–î–ï–¢ –†–ê–ë–û–¢–ê–¢–¨!</div>–í—Å–µ API endpoints –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ';
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '<div class="status">‚ùå –û–°–ù–û–í–ù–ê–Ø –§–û–†–ú–ê –ù–ï –ë–£–î–ï–¢ –†–ê–ë–û–¢–ê–¢–¨</div>' + JSON.stringify(result, null, 2);
                }
                
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '<div class="status">‚ùå –û–°–ù–û–í–ù–ê–Ø –§–û–†–ú–ê –ù–ï –ë–£–î–ï–¢ –†–ê–ë–û–¢–ê–¢–¨</div>' + error.message;
            }
        }
    </script>
</body>
</html>
